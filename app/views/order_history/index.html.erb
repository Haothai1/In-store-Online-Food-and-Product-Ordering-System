<div class="container mt-4">
  <h1 class="mb-4">Order History</h1>

  <% if @orders.any? %>
    <div class="accordion" id="orderAccordion">
      <% @orders.each_with_index do |order, index| %>
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading<%= index %>">
            <button class="accordion-button <%= 'collapsed' unless index.zero? %>" type="button" data-bs-toggle="collapse" data-bs-target="#collapse<%= index %>" aria-expanded="<%= index.zero? ? 'true' : 'false' %>" aria-controls="collapse<%= index %>">
              Order #<%= order.id %> - <%= order.created_at.strftime("%B %d, %Y") %> - <%= number_to_currency(order.total_price) %>
            </button>
          </h2>
          <div id="collapse<%= index %>" class="accordion-collapse collapse <%= 'show' if index.zero? %>" aria-labelledby="heading<%= index %>" data-bs-parent="#orderAccordion">
            <div class="accordion-body">
              <p><strong>Status:</strong> <%= order.status.capitalize %></p>
              <p><strong>Order Type:</strong> <%= order.order_type.capitalize %></p>
              
              <h5 class="mt-3">Items:</h5>
              <ul class="list-group">
                <% order.order_items.each do |item| %>
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    <%= item.product.name %>
                    <span>
                      Quantity: <%= item.quantity %> - 
                      Price: <%= number_to_currency(item.price) %>
                    </span>
                  </li>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="alert alert-info">You haven't placed any orders yet.</div>
  <% end %>

  <div class="mt-4">
    <%= link_to 'Back to Store', store_path, class: 'btn btn-secondary me-2' %>
    <%= link_to 'Back to Menu', menu_path, class: 'btn btn-secondary' %>
  </div>
  
</div>
